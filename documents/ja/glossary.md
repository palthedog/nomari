# 用語集

このドキュメントでは、Nomariアプリ内で使用される用語について説明します。

## シナリオ関連

### Scenario (シナリオ)

ゲームの状況定義の最上位レベルのコンテナです。以下の要素を含みます：

- シチュエーション（Situation）のリスト
- 終端シチュエーション（TerminalSituation）のリスト
- プレイヤーコンボ（ComboStarter）のリスト
- 相手コンボ（ComboStarter）のリスト
- 初期動的状態（DynamicState）
- 報酬計算方法（RewardComputationMethod）

### Situation (シチュエーション)

ゲームにおける1つの状況を表します。各シチュエーションには：

- プレイヤーが取れる行動のリスト
- 相手が取れる行動のリスト
- 行動の組み合わせに応じた遷移先

が定義されています。

### TerminalSituation (終端シチュエーション)

ゲームツリーの末端となる状況です。ここで報酬が計算されます。

- 例：「起き攻め終了」「ニュートラルに戻る」など
- コーナー状態（CornerState）を持つことができ、報酬計算に影響します

### ComboStarter (コンボスターター)

コンボの分岐点を表すノードです。ゲージ状態に応じて複数のルートから選択できます。

- **プレイヤーコンボ**: プレイヤーが相手にヒットさせた時のコンボ
- **相手コンボ**: 相手がプレイヤーにヒットさせた時のコンボ

### ComboRoute (コンボルート)

コンボスターターから分岐する各ルートです。

- 必要なリソース条件（例：OD >= 2）
- 消費するリソース（例：相手体力 -3000、OD -2）
- 遷移先のシチュエーション

を持ちます。

## 状態関連

### DynamicState (動的状態)

ゲームの進行に伴い変化する状態を表します。主にリソースのリストで構成されます。

### ResourceType (リソースタイプ)

追跡可能なリソースの種類：

| リソース | 説明 |
|---------|------|
| PLAYER_HEALTH | プレイヤー体力 |
| OPPONENT_HEALTH | 相手体力 |
| PLAYER_OD_GAUGE | プレイヤーODゲージ |
| OPPONENT_OD_GAUGE | 相手ODゲージ |
| PLAYER_SA_GAUGE | プレイヤーSAゲージ |
| OPPONENT_SA_GAUGE | 相手SAゲージ |

### ResourceConsumption (リソース消費)

遷移時に消費されるリソースの量を定義します。

- 例：「相手体力を2000減らす」

### ResourceRequirement (リソース要件)

遷移を行うために必要なリソースの最低値を定義します。

- 例：「SAゲージが3以上必要」

## 行動・遷移関連

### Action (アクション)

プレイヤーまたは相手が選択できる行動です。

- 例：「打撃重ね」「投げ」「シミー」「ガード」「無敵暴れ」

### Transition (遷移)

プレイヤーと相手の行動の組み合わせによる結果を定義します。

- プレイヤーの行動ID
- 相手の行動ID
- 遷移先のシチュエーションID
- リソース消費
- リソース要件

### CornerState (コーナー状態)

終端シチュエーションにおける画面端の状況：

| 状態 | 説明 |
|------|------|
| NONE | どちらも画面端にいない |
| PLAYER_IN_CORNER | プレイヤーが画面端にいる |
| OPPONENT_IN_CORNER | 相手が画面端にいる |

## 報酬計算関連

### RewardComputationMethod (報酬計算方法)

終端ノードでの報酬を計算する方法です。

#### DamageRace (ダメージレース)

与えたダメージと受けたダメージの差で報酬を計算します。

- 報酬 = (相手に与えたダメージ) - (受けたダメージ)

#### WinProbability (勝率ベース)

残り体力から勝率を推定して報酬を計算します。

- 体力差に基づいて -10000 〜 +10000 の範囲で報酬を計算
- `cornerBonus`: 相手が画面端にいる場合のコンボダメージボーナス
- `odGaugeBonus`: ODゲージあたりの致死コンボダメージボーナス
- `saGaugeBonus`: SAゲージあたりの致死コンボダメージボーナス

## ゲームツリー関連

### GameTree (ゲームツリー)

シナリオから構築された展開済みのゲームツリーです。

- 各ノードは (シチュエーション, 動的状態) の組み合わせに対応
- 同じシチュエーションでも体力が異なれば別のノードになります

### Node (ノード)

ゲームツリーの1つの状態を表します。

- シチュエーションノード：行動選択がある通常のノード
- 終端ノード：報酬が確定している末端のノード

## 戦略関連

### GTO (Game Theory Optimal)

ゲーム理論的最適戦略の略。相手がどのような戦略を取っても、期待値が最大化される戦略です。

### 混合戦略 (Mixed Strategy)

複数の行動を確率的に選択する戦略です。Nomariは各行動の最適な選択確率を計算します。

### 期待値 (Expected Value)

ある戦略を取った時に平均的に得られる報酬の値です。
